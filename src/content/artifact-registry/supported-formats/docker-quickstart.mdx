import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

This guide will help you **create a Docker Artifact Registry** in Harness, **configure an upstream proxy**, and **manage Docker images**.

## Prerequisites
- Ensure you have Docker CLI installed and configured on your local machine.
- Access to a Harness account with appropriate permissions to create registries and connectors. ￼

---
## Create a Docker Artifact Registry
<Tabs>
<TabItem value="Interactive Guide">
<DocVideo src="https://app.tango.us/app/embed/21a8f737-f90b-4864-a3b9-0538f80be7a5?skipCover=false&defaultListView=false&skipBranding=false&makeViewOnly=true&hideAuthorAndDetails=true" title="Create a Docker Artifact Registry in Harness" />
</TabItem>
<TabItem value="Step-by-Step">

1. Navigate to the Artifact Registry module in your Harness project.
2. Click on + New Artifact Registry.
3. In the Registry Type dropdown, select Docker Registry.
4. Provide a Registry Name (must start with a letter and can include lowercase alphanumerics, _, ., and -).
5. Optionally, add a Description and Labels for better organization.
6. Click Create Registry to finalize.
</TabItem>
</Tabs>

:::info private Docker registry
This registry will serve as your private Docker registry within Harness. 
:::

---
## Configure an Upstream Proxy (Optional)
An upstream proxy allows your registry to fetch Docker images from external sources if they are not available locally. 

<Tabs>
<TabItem value="Interactive Guide">
<DocVideo src="https://app.tango.us/app/embed/f9437754-7cdf-4c19-9c94-9932c7e1a46a?skipCover=false&defaultListView=false&skipBranding=false&makeViewOnly=true&hideAuthorAndDetails=true" title="Create Upstream Proxy Configuration" />
</TabItem>
<TabItem value="Step-by-Step">

1. In the Artifact Registry module, click the dropdown next to + New Artifact Registry and select Upstream Proxy.
2. Choose Docker Registry as the proxy type.
3. Provide a Proxy Name and the URL of the external Docker registry (e.g., Docker Hub).
4. Configure authentication if required by the external registry.
5. Click Create Proxy to establish the connection.
</TabItem>
</Tabs>
:::info upstream proxy caching
This setup ensures that if a Docker image isn’t found in your Harness registry, it can be retrieved from the specified external source.
:::

---
## Push & Pull images
### Authenticate Docker CLI with Harness Registry
1. In your Harness Docker Artifact Registry, click on Setup Client.
2. Copy the provided docker login command.
3. Execute the command in your terminal to authenticate your Docker CLI with the Harness registry. ￼

### Push a Docker Image to Harness Registry

1. Tag your Docker image to match the Harness registry format:

```bash
docker tag your-image:tag <harness-registry-url>/your-image:tag
```
2. Push the image to the Harness registry:

```bash
docker push <harness-registry-url>/your-image:tag
```

**Replace `<harness-registry-url>` with the URL of your Harness Docker registry.**

### Pull a Docker Image from Harness Registry
1. Ensure you’re authenticated with the Harness registry (see Step 3).
2. Pull the desired image:
```bash
docker pull <harness-registry-url>/your-image:tag
```

:::info docker pull command
This command retrieves the Docker image from your Harness registry to your local environment.
:::

---
By following this guide, you can effectively set up and manage a Docker Artifact Registry within Harness, streamlining your container image workflows.