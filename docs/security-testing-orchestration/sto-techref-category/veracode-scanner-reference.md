---
title: Veracode step configuration
description: Scan code repositories with Veracode.
sidebar_label: Veracode step configuration
sidebar_position: 410
helpdocs_topic_id: cy0deg32w9
helpdocs_category_id: m01pu2ubai
helpdocs_is_private: false
helpdocs_is_published: true
---

<DocsTag  text="Orchestration" backgroundColor= "#e3cbf9" textColor="#5c0bad" link="/docs/security-testing-orchestration/get-started/key-concepts/run-an-orchestrated-scan-in-sto"  />
<DocsTag  text="Extraction" backgroundColor= "#e3cbf9" textColor="#5c0bad" link="/docs/security-testing-orchestration/get-started/key-concepts/sto-workflows-overview#extraction-scans-in-sto" />
<DocsTag  text="Ingestion" backgroundColor= "#e3cbf9" textColor="#5c0bad" link="/docs/security-testing-orchestration/get-started/key-concepts/ingest-scan-results-into-an-sto-pipeline" />
<br/>
<br/>

The Veracode step in Harness STO identifies security issues in your application code. It supports [Veracode Static Analysis](https://docs.veracode.com/r/c_static_overview), which includes Static Application Security Testing (SAST) and Software Composition Analysis (SCA). While this step does not execute [Dynamic Application Security Testing (DAST)](https://docs.veracode.com/r/Dynamic_Analysis), it can automatically retrieve existing DAST scan results from the Veracode platform to STO during any scan mode execution, provided the DAST scan results are already available in Veracode platform.

Based on your requirements, you can choose from the following three STO scan modes. Each mode is explained in a dedicated section with detailed instructions.

- **[Orchestration Mode](#orchestration-mode-configuration)**: In this mode, you can initiate a scan directly in Veracode from STO. The scan results are automatically saved in STO.

- **[Ingestion Mode](#ingestion-mode-configuration)**: Use this mode to import scan results from a data file into STO. This section guides you on ingesting scan results from an XML file generated by Veracode.

- **[Extraction Mode](#extraction-mode-configuration)**: Extraction Mode allows you to retrieve the latest scan data of a specific Veracode Application's scan and import it into STO.

To understand the details of each field in the Veracode step, you can refer to [Veracode step settings](#veracode-step-settings).

:::info
- You can utilize custom STO scan images and pipelines to run scans as a non-root user. For more details, refer [Configure your pipeline to use STO images from private registry](/docs/security-testing-orchestration/use-sto/set-up-sto-pipelines/configure-pipeline-to-use-sto-images-from-private-registry).
- STO supports three different approaches for loading self-signed certificates. For more information, refer [Run STO scans with custom SSL certificates](/docs/security-testing-orchestration/use-sto/secure-sto-pipelines/ssl-setup-in-sto/#supported-workflows-for-adding-custom-ssl-certificates).


import StoMoreInfo from '/docs/security-testing-orchestration/sto-techref-category/shared/_more-information.md';

<StoMoreInfo />
:::

## Orchestration mode configuration
The Orchestration mode in Veracode step allows you to initiate a scan on your configured codebase in your Harness pipeline stage. This mode will perform SAST, SCA, and Policy evaluations, the results are then saved in STO. Here's how you can configure an Orchestration in Veracode step

Search for and add the **Veracode** step to your pipeline. This step can be used in either the **Build** stage or the **Security** stage. In the step configuration, set the following fields:

1. **Scan Mode**: Set the **Scan Mode** to **Orchestration**.

2. **Scan Configuration**: Based on your requirements, choose between [**Default**](#default) or [**Sandbox Scan**](#sandbox-scan) as the scan configuration.

3. **Target**: The **[Type](#type)** is to Repository by default. For **[Target and Variant Detection](#target-and-variant-detection)**, you can use the [**Auto**](#target-and-variant-detection) option to let STO set the **Name** and **Varient** fields for you. Or, you can manually define them using the **Manual** option.

4. **Workspace**(optional): Specify the path to the file or directory you want to scan in the [Workspace](#workspace) field. If this field is left blank, the entire repository will be scanned.

5. **Authentication**: Select the Authentication [**Type**](#type-1) as either [**API Key**](#api-key) or [**Username and Password**](#username-and-password). Based on the type, configure the **Access Id** and **Access Token**.

6. **App Id**(optional):  In the **Scan Tool** section, you can enter the Veracode [**App Id**](#app-id) of the application you want to use for the scan. If this field is left blank, the step will attempt to locate an application using the **Target Name** you provided. If no matching application is found, a new Veracode Application will be created automatically with the name format `harness-HARNESS_PROJECT_ID-TARGET_NAME`. Additionally, refer to [this section](#using-an-existing-veracode-application-created-by-sto) to learn more on how to use an existing Veracode Application created by STO.

7. **Sandbox Id**(optional): This field appears if you select **Sandbox Scan** as your [Scan Configuration](#scan-configuration). You can enter your [**Sandbox Id**](#sandbox-id) to use an existing Veracode Sandbox. If left blank, STO will create a new Sandbox automatically, naming it in the format `s-harness-HARNESS_PROJECT_ID-TARGET_NAME`.

<DocImage path={require('./static/veracode-orchestration.png')} width="40%" height="40%" title="Click to view full size image" />


These are the essential settings for performing an Orchestration scan using the Veracode step. For more features and configuration options, refer [Veracode Step Settings](#veracode-step-settings) section.

## Ingestion mode configuration
With the Ingestion mode in the Veracode step, you can read scan results from a data file and import them into STO. To do this, you need the scan results saved in the XML format. Importantly, before you can ingest scan results, you must perform all the Veracode prerequisites for the repo that you're scanning. If you're scanning a Java repo, for example, the Veracode documentation outlines the specific packaging and compilation requirements for scanning your Java applications. For specific requirements, go to the [Veracode docs](https://docs.veracode.com/) and search for Veracode Packaging Requirements.

Here's how you can configure your Veracode step to Ingest the scan results from the XML data file downloaded from Veracode portal.

1. Search for and add the **Veracode** step to your pipeline.

2. **Scan Mode**: Set the **Scan Mode** to **Ingestion**.

3. **Target**: The **[Type](#type)** is to Repository by default. For **[Target and Variant Detection](#target-and-variant-detection)**, define the **Name** and **Varient** manually.

4. **Ingestion File**: For the field [**Ingestion File**](#ingestion-file), enter the path where the XML scan results file is saved. for example `/harness/output.xml`

<DocImage path={require('./static/veracode-ingestion.png')} width="40%" height="40%" title="Click to view full size image" />

## Extraction mode configuration
The Extraction mode in Veracode step allows you to retrieve the latest scan data of a specific Veracode Application and feed the results into STO. Here's how you can do it.

Search for and add the **Veracode** step to your pipeline. This step can be used in either the **Build** stage or the **Security** stage. In the step configuration, set the following fields:

1. **Scan Mode**: Set the **Scan Mode** to **Extraction**.

2. **Scan Configuration**: If your scan results needs to be reirived from a Sandbox you can choose **Sandbox Scan**. Else, you can use **Default**.

3. **Target**: The **[Type](#type)** is to Repository by default. For **[Target and Variant Detection](#target-and-variant-detection)**, you can use the [**Auto**](#target-and-variant-detection) option to let STO set the **Name** and **Variant** fields for you. Or, you can manually define them using the **Manual** option.

4. **Authentication**: Select the Authentication [**Type**](#type-1) as either [**API Key**](#api-key) or [**Username and Password**](#username-and-password). Based on the type, configure the **Access Id** and **Access Token**.

**App Id**(optional): In the **Scan Tool** section, you can provide the Veracode [App Id](#app-id) of the application from which you want to fetch scan results. If left blank, the step will try to locate an application using the **Target Name** you specified. Note that the step can only find applications previously created by STO during orchestration, as it relies on the specific naming convention used by STO. Additionally, refer to [this section](#using-an-existing-veracode-application-created-by-sto) to learn more on how to use an existing Veracode Application created by STO.

6. **Sandbox Id**: This field appears if you select **Sandbox Scan** as your [Scan Configuration](#scan-configuration). You can enter your [**Sandbox Id**](#sandbox-id) to use an existing Veracode Sandbox.

<DocImage path={require('./static/veracode-extraction.png')} width="40%" height="40%" title="Click to view full size image" />

## Veracode step settings
The following are the details of each field in the Veracode step.

### Scan Mode
The Veracode step in STO supports three scan modes, Orchestration, Ingestion, and Extraction. Refer to the documentation specific to each mode for details and configuration instructions.

### Scan Configuration
The predefined configuration used for the scan. The Veracode step supports Default and Sandbox Scan

#### Default 
For Orchestration, the scan will take place in Veracode platform but not in any Sandbox.

#### Sandbox Scan
For Orchestration, the scan will take place in a Veracode Sandbox. If you and do not provide the sandbox id to the **[Sandbox Id](#sandbox-id)** field, the step can automatically create a new sandbox to perform the scan.

### Target

#### Type
The type is set to **Repository** by default, which is used to scan a code repository.

#### Target and Variant Detection
You can configure the details of your scan by specifying its **Name** and **Variant**, which are labels assigned to the target you are scanning. These can be set manually by selecting the **Manual** option or configured automatically by selecting **Auto**. In Auto mode, the **Name** is derived from the repository name, and the **Variant** is set to the branch name.

Additionally, in Orchestration mode, the **Name** is used as part of the Veracode Application creation process and included in the Veracode Application name.

#### Workspace 


import StoSettingTargetWorkspace from './shared/step_palette/target/_workspace.md';

<StoSettingTargetWorkspace  />

### Authentication

#### Type
Authentication can be configured using one of two methods, **API Key** or **Username and Password**. Each method requires specific credential configurations. It is recommended to use the **API Key** method over the **Username and Password** method for better security. To securely store and reference your credentials, create a Harness text secret and use the format `<+secrets.getValue("veracode_id")>`. For detailed steps, refer to [Add and Reference Text Secrets](/docs/platform/secrets/add-use-text-secrets).

#### API Key
Enter your **Veracode ID** in the **Access Id** field and your **Veracode Secret Key** in the **Access Token** field.

#### Username and Password
Enter your account username in the **Access Id** field and your password in the **Access Token** field.

### Scan Tool

#### App Id
Enter your Veracode **Application ID**. To find the **App ID**, navigate to the homepage of the Veracode Application whose results you want to scan. The **App ID** is the number that appears at the end of the URL. 

For example, in the following URL:  
`https://analysiscenter.veracode.com/auth/index.jsp#HomeAppProfile:88881:1973759`  
The **App ID** is `1973759`.

#### Sandbox Id
Enter your Sandbox id. To find the Sandbox Id, navigate to your Sandbox page. The Sandbox Id is the number that appears at the end of the URL.

For example, in the following URL:
`https://analysiscenter.veracode.com/auth/index.jsp#SandboxView:104077:2367896:6899436`
The **Sandbox Id** is `6899436`

### Ingestion File

import StoSettingIngestionFile from './shared/step_palette/ingest/_file.md';

<StoSettingIngestionFile  />

### Log Level

import StoSettingLogLevel from './shared/step_palette/all/_log-level.md';

<StoSettingLogLevel />

### Fail on Severity

import StoSettingFailOnSeverity from './shared/step_palette/all/_fail-on-severity.md';

<StoSettingFailOnSeverity />

### Settings

import StoSettingSettings from './shared/step_palette/all/_settings.md';

<StoSettingSettings />


### Additional Configuration

import ScannerRefAdditionalConfigs from './shared/_additional-config.md';

<ScannerRefAdditionalConfigs />


### Advanced settings

import ScannerRefAdvancedSettings from './shared/_advanced-settings.md';

<ScannerRefAdvancedSettings />

## View Veracode policy failures
Veracode policy failures will appear in scan results as `Info` severity issues, with the issue type set to `EXTERNAL_POLICY`. Successfully passed policies will not be included in the scan results.  Additionally, you can apply [OPA policies](/docs/security-testing-orchestration/policies/create-opa-policies) in Harness STO to enforce or manage the policy failures.

## Using an existing Veracode Application created by STO
If you want to reuse an existing Veracode Application created by STO during a previous Orchestration, you have two approaches. 
1. You can provide the Veracode Application ID in the **App Id** field to directly reference the existing application. The step will use the appropriate Veracode Application.
2. You can set the **Target Name** to match the one used in your previous Orchestration. If the Veracode Application name follows the standard format (e.g., `harness-D2dLdFdfF-dvpwa`), you can simply enter the last part of the name, such as `dvpwa`, as the **Target Name**, and the step will automatically use that Application. In this case, you can leave the **App Id** field blank. However, this approach only works if the application name is in the exact format expected by the step, as it uses this structure to locate the application.