---
title: Ingest Software Bill of Materials (SBOM) data into SCS
description: Harness SCS can ingest data from STO scanners that can generate an SBOM.
sidebar_label: Ingest SBOM from STO Scanners
sidebar_position: 20
redirect_from:

- /docs/software-supply-chain-assurance/sbom/generate-sbom-aqua-trivy
- /docs/software-supply-chain-assurance/sbom/generate-sbom-blackduck
- /docs/software-supply-chain-assurance/sbom/generate-sbom-snyk
---


import CosignKeyGeneration from '/docs/software-supply-chain-assurance/shared/generate-cosign-key-pair.md';

Harness SCS offers flexible SBOM management. It can ingest SBOMs generated from Security Testing Orchestration (STO) scanner steps, like the [Aqua Trivy STO step](/docs/security-testing-orchestration/sto-techref-category/trivy/aqua-trivy-scanner-reference.md), provided the SBOM is in JSON format ([SPDX](https://spdx.dev/learn/overview/) or [CycloneDX](https://cyclonedx.org/specification/overview/)). This guide details configuring a pipeline to seamlessly ingest SBOMs generated by Trivy. Similarly, you can follow the same steps for the other STO scanners (Blackduck, Snyk).

Alternatively, you can leverage built-in tools in SCS for SBOM generation or ingest SBOMs from any external tool.  Refer to our dedicated guides for these functionalities: 
- [Generate SBOM using Harness SCS](/docs/software-supply-chain-assurance/open-source-management/generate-sbom-for-repositories).
- [Ingest SBOM from any SBOM tool](/docs/software-supply-chain-assurance/open-source-management/ingest-sbom-data).

## Generate the keys for SBOM Attestation - optional
import GenerateKeysPrerequisite from '/docs/software-supply-chain-assurance/shared/generate-consign-keys-prerequisite.md';

<GenerateKeysPrerequisite />


## Configure the STO scan step to generate SBOM

Configure an STO scanner step, such as the [Aqua Trivy STO step](/docs/security-testing-orchestration/sto-techref-category/trivy/aqua-trivy-scanner-reference.md), and make sure you select **Generate SBOM** and the **SBOM Format**.

<DocImage path={require('./static/generate-sbom-blackduck-00.png')} width="60%" height="60%" title="Click to view full size image" />

## Get the SBOM file path

The Aqua Trivy STO step creates a `JOB_ID` [output variable](/docs/continuous-integration/use-ci/run-step-settings.md#output-variables) that you can use to reference the SBOM file path in the **SBOM Orchestration** step.

1. Replace `STAGE_ID` and `STEP_ID` in the following [Harness expression](/docs/platform/variables-and-expressions/runtime-inputs.md#expressions) with the stage ID and step ID for your Aqua Trivy STO step.

   ```
   <+pipeline.stages.STAGE_ID.spec.execution.steps.STEP_ID.output.outputVariables.JOB_ID>
   ```

2. Use the expression in your SBOM file path. The exact path depends on where your scanner outputs SBOM files. For example, this filepath references an Aqua Trivy STO step with the ID `myaquatrivystep` in a stage with the ID `mybuildstage`:

   ```
   /addon/results/<+pipeline.stages.mybuildstage.spec.execution.steps.myaquatrivystep.output.outputVariables.JOB_ID>.sbom
   ```

:::tip

Alternately, you can get the output path and output variable expression from a previous run of the same pipeline. To do this, go to the execution details page, select the stage with the STO scanner step, and then select the STO scanner step. In the step's logs, you can find the output path, and you can get the output variable from the **Output** tab.

<DocImage path={require('./static/generate-sbom-blackduck-02.gif')} width="60%" height="60%" title="Click to view full size image" />
:::

## Configure the SBOM Orchestration step

Add an [SBOM Orchestration step](/docs/software-supply-chain-assurance/open-source-management/generate-sbom-for-repositories#sbom-orchestration-step-configuration) and configure to ingest the SBOM.

:::info
**SBOM Orchestration** step in deploy stage can only be used in the [Containerized Step Groups](/docs/continuous-delivery/x-platform-cd-features/cd-steps/containerized-steps/containerized-step-groups.md)
:::

* **Step Mode:** Set the step mode to **Ingestion**.
* **SBOM File Path:** enter the SBOM file path that uses the `JOB_ID` value, as detailed in [Get the SBOM file path](#get-the-sbom-file-path).
* **Source:** Set the source, which can be DockerHub, ECR, GCR, ACR or Repository. Depending on your selection, a unique set of fields will appear, each specific to the source you've chosen. Address these fields as required, this is similar to configuring the source in SBOM Orchestration step. For more details of what each field entails, please refer to the [documentation on SBOM Orchestration](/docs/software-supply-chain-assurance/open-source-management/generate-sbom-for-repositories#sbom-orchestration-step-configuration). If you are using DockerHub, you can follow along.
* **Image:**, Enter the name of your image with tag, such as `my-docker-org/repo-name:tag`.
   <details>
      <summary>Generate key pairs using Cosign for SBOM Attestation</summary>

      <CosignKeyGeneration />

   </details>

* **Private Key (optional):** Input your Private key from the [Harness file secret](/docs/platform/secrets/add-file-secrets).

* **Password (optional):** Input your Password for the Private key from the [Harness file secret](/docs/platform/secrets/add-file-secrets).

<DocImage path={require('./static/generate-sbom-blackduck-01.png')} width="50%" height="50%" title="Click to view full size image" />

